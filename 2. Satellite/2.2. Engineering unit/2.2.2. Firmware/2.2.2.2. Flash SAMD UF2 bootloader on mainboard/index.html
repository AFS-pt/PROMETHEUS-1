<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://wp-net.github.io/prometheus/2.%20Satellite/2.2.%20Engineering%20unit/2.2.2.%20Firmware/2.2.2.2.%20Flash%20SAMD%20UF2%20bootloader%20on%20mainboard/" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>Flash SAMD UF2 bootloader on mainboard - PROMETHEUS-1 Wiki</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Flash SAMD UF2 bootloader on mainboard";
        var mkdocs_page_input_path = "2. Satellite/2.2. Engineering unit/2.2.2. Firmware/2.2.2.2. Flash SAMD UF2 bootloader on mainboard.md";
        var mkdocs_page_url = "/prometheus/2.%20Satellite/2.2.%20Engineering%20unit/2.2.2.%20Firmware/2.2.2.2.%20Flash%20SAMD%20UF2%20bootloader%20on%20mainboard/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> PROMETHEUS-1 Wiki
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../..">Welcome to the PROMETHEUS-1 project wiki!</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">2. Satellite</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">2.1. Guide introduction</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.1.%20Guide%20introduction/2.1.1.%20Guide%20description/">Guide description</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">2.2. Engineering unit</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="#">2.2.1. Hardware</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.1.%20Hardware/2.2.1.1.%20Printed%20circuit%20boards/">Printed Circuit Boards (PCBs)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.1.%20Hardware/2.2.1.2.%20Antenna/">Antenna</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.1.%20Hardware/2.2.1.3.%20Rails/">Rails</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.1.%20Hardware/2.2.1.4.%20Standoffs%2C%20inserts%20and%20screws/">Standoffs, inserts and screws</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.1.%20Hardware/2.2.1.5.%20Mounting%20base/">Mounting base</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">2.2.2. Firmware</a>
    <ul class="current">
                <li class="toctree-l3"><a class="reference internal" href="../2.2.2.1.%20Firmware%20description/">Firmware description</a>
                </li>
                <li class="toctree-l3 current"><a class="reference internal current" href="./">Flash SAMD UF2 bootloader on mainboard</a>
    <ul class="current">
    <li class="toctree-l4"><a class="reference internal" href="#what-you-need">What you need</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-1-set-up-your-pc">Step 1: Set up your PC</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-2-flash-the-bootloader">Step 2: Flash the bootloader</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../2.2.2.3.%20Flash%20CircuitPython%20on%20mainboard/">Flash CircuitPython on mainboard</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">2.2.3. Software</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.3.%20Software/2.2.3.1.%20Software%20description/">Software description</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.3.%20Software/2.2.3.2.%20Build%20an%20application/">Build an application</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.3.%20Software/2.2.3.3.%20Flash%20an%20application/">Flash an application</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">2.2.4. Unitary testing</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.4.%20Unitary%20testing/2.2.4.1.%20Unitary%20testing%20description/">Unitary testing</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.4.%20Unitary%20testing/2.2.4.2.%20Mainboard%20payload/">Mainboard payload</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.4.%20Unitary%20testing/2.2.4.3.%20LoRa%20communication/">LoRa communication</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.4.%20Unitary%20testing/2.2.4.4.%20Camera%20detection/">Camera detection</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">2.2.5. Assembly</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.5.%20Assembly/2.2.5.1.%20Assembly%20description/">Assembly description</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.5.%20Assembly/2.2.5.2.%20Creating%20an%20antenna/">Creating an antenna</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.5.%20Assembly/2.2.5.3.%20Placing%20inserts%20on%20rails/">Placing inserts on rails</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.5.%20Assembly/2.2.5.4.%20Assemblying%20the%20satellite/">Assemblying the satellite</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.5.%20Assembly/2.2.5.5.%20Charging%20the%20batteries/">Charging the batteries</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">2.2.6. System check</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../2.2.6.%20System%20check/2.2.6.1.%20System%20check%20description/">System check</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">2.3. Flight unit</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.3.%20Flight%20unit/2.3.1.%20Flight%20unit%20considerations/">Flight unit considerations</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">PROMETHEUS-1 Wiki</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">2. Satellite</li>
          <li class="breadcrumb-item">2.2. Engineering unit</li>
          <li class="breadcrumb-item">2.2.2. Firmware</li>
      <li class="breadcrumb-item active">Flash SAMD UF2 bootloader on mainboard</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="flash-samd-uf2-bootloader-on-mainboard">Flash SAMD UF2 bootloader on mainboard</h1>
<p>Based on <a href="https://github.com/PyCubed-Mini/avionics-mainboard/wiki/Flashing-UF2-Bootloader-on-the-ATSAMD51">RExLab tutorial</a>:</p>
<blockquote>
<p>The following procedure needs to be performed only once (barring any bricking / updating the bootloader) on a newly assembled mainboard with an unprogrammed MCU - in our case, the ATSAMD51J19A.</p>
<p><br /> </p>
<h2 id="what-you-need">What you need</h2>
<ul>
<li>
<p>ATSAMD51 board (such as the PyCubed-Mini mainboard);</p>
</li>
<li>
<p>Windows PC with atleast 2 free USB ports;</p>
</li>
<li>
<p>SEGGER J-Link (we use the EDU Mini model);</p>
</li>
<li>
<p>2x5 pin 1.27mm pitch ribbon cable;</p>
</li>
<li>
<p>USB-C and micro-USB cables, both with power and data lines;</p>
</li>
<li>
<p>SAMD bootloader binary file.</p>
</li>
</ul>
<p><br /> </p>
<h2 id="step-1-set-up-your-pc">Step 1: Set up your PC</h2>
<ul>
<li>
<p>Visit <a href="https://www.microchip.com/en-us/tools-resources/develop/microchip-studio#Downloads">Microchip Studio download page</a>, scroll down, and download the Web installer version of Microchip Studio. (The offline installer should also work, however I have had issues with antivirus software blocking it);</p>
</li>
<li>
<p>Accept the Terms and Conditions, and deselect the "Send anonymous data" box. On the next page, select the architectures you'd like to install - we will only be using SAM boards. Finally, deselect "Advanced Software Framework and Example Projects" as these are not necessary. The rest of the installation should be fairly straightforward;</p>
</li>
<li>
<p>If asked to install the XC8 compiler, simply hit "OK" without installing - it is not necessary for this guide;</p>
</li>
<li>
<p>Microchip Studio should now be set up and open;</p>
</li>
<li>
<p>Next, visit <a href="https://www.segger.com/downloads/jlink/">SEGGER J-Link download page</a>, and download the latest Windows version of the J-Link software. The install process for this is fairly straightforward. The default settings should work fine;</p>
</li>
<li>
<p>A new SEGGER J-Link DLL Updater window will open asking to update Atmel Studio to the latest SEGGER software version. Make sure the check mark is selected and click "OK";</p>
</li>
<li>
<p>Your computer is now ready for flashing the bootloader.</p>
</li>
</ul>
</blockquote>
<p><br /> </p>
<h2 id="step-2-flash-the-bootloader">Step 2: Flash the bootloader</h2>
<ul>
<li>
<p>Plug one end of the ribbon cable on 2x5 connector of the main board. Make sure pin 1 of the ribbon cable (red wire) is matching pin 1 of the board connector (longer silkscreen mark); </p>
</li>
<li>
<p>Plug the other end on the J-Link. Make sure pin 1 of the ribbon cable is matching pin 1 of the connector (white dot);</p>
</li>
<li>
<p>Plug the J-Link on your PC with the micro-USB cable;</p>
</li>
<li>
<p>Plug the the main board on your PC with the USB-C cable;</p>
</li>
</ul>
<p><img alt="Pin 1" src="https://github.com/AFS-pt/PROMETHEUS-1_dev/blob/main/2.Satellite/images/i08.pin1.png?raw=true" /></p>
<p>Based on <a href="https://learn.adafruit.com/how-to-program-samd-bootloaders/programming-the-bootloader-with-atmel-studio#verify-connection-in-atmel-studio-3016767">AdaFruit tutorial</a>:</p>
<blockquote>
<ul>
<li>
<p>Next, open Atmel Studio. From the toolbar, select "Tools" -&gt; "Device Programming";</p>
</li>
<li>
<p>The device programming window will open. Then, select "Tool" -&gt; "J-Link";</p>
</li>
<li>
<p>If you're using a J-Link EDU, accept the terms of use that will pop up after selecting the J-Link interface;</p>
</li>
<li>
<p>After that, select the Device (the type of chip you're programming): ATSAMD51J19A and click "Read" in the top navigation bar. The empty fields for Device Signature and Target Voltage should populate;</p>
</li>
</ul>
<p><em>NOTE: Make sure these values appear before proceeding! If the board or your wiring is not detected, Atmel Studio will throw an error that it could not connect to the board. Check your wiring and try to connect again.</em></p>
<ul>
<li>
<p>On the sidebar, click Memories. On Flash, select the bootloader binary file that you either built or downloaded, and mark "Erase Flash before programming";</p>
</li>
<li>
<p>Click "Program", then "Verify";</p>
</li>
</ul>
<p><em>NOTE: After clicking, the serial should output "OK" for each action, and there should be a new USB volume mounted on your machine.</em></p>
</blockquote>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../2.2.2.1.%20Firmware%20description/" class="btn btn-neutral float-left" title="Firmware description"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../2.2.2.3.%20Flash%20CircuitPython%20on%20mainboard/" class="btn btn-neutral float-right" title="Flash CircuitPython on mainboard">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../2.2.2.1.%20Firmware%20description/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../2.2.2.3.%20Flash%20CircuitPython%20on%20mainboard/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
